jQuery.extend({createDownloadForm:function(a,d,f){var e="downloadform"+new Date().getTime();var c=jQuery('<form  action="'+a+'"  method="'+(f||"post")+'" name="'+e+'" id="'+e+'" ></form>');if(d){for(var b in d){jQuery('<input type="hidden" name="'+b+"\" value='"+d[b].replace(/\'/g,'"')+"' />").appendTo(c);}}jQuery(c).css("position","absolute");jQuery(c).css("top","-1200px");jQuery(c).css("left","-1200px");jQuery(c).appendTo("body");return c;},ajaxFileDownload:function(a){a=jQuery.extend({},jQuery.ajaxSettings,a);var b=jQuery.createDownloadForm(a.url,a.data,a.method);jQuery(b).submit().remove();}});jQuery.extend({createUploadIframe:function(d,b){var a="jUploadFrame"+d;var c='<iframe id="'+a+'" name="'+a+'" style="position:absolute; top:-9999px; left:-9999px"';if(window.ActiveXObject){if(typeof b=="boolean"){c+=' src="javascript:false"';}else{if(typeof b=="string"){c+=' src="'+b+'"';}}}c+=" />";jQuery(c).appendTo(document.body);return jQuery("#"+a).get(0);},createUploadForm:function(a,k,e,b){var j="jUploadForm"+a;var d="jUploadFile"+a;var c=jQuery('<form  action="" method="POST" name="'+j+'" id="'+j+'" enctype="multipart/form-data"></form>');if(e){for(var f in e){jQuery('<input type="hidden" name="'+f+"\" value='"+e[f].replace(/\'/g,'"')+"' />").appendTo(c);}}var g;if(b==null){g=jQuery("#"+k);}else{g=b;}var h=jQuery(g).clone();jQuery(g).attr("id",d);jQuery(g).before(h);jQuery(g).appendTo(c);jQuery(c).css("position","absolute");jQuery(c).css("top","-1200px");jQuery(c).css("left","-1200px");jQuery(c).appendTo("body");return c;},ajaxFileUpload:function(l){l=jQuery.extend({},jQuery.ajaxSettings,l);var k=true;if(l.beforeUpload){k=l.beforeUpload();}if(k!=undefined&&!k){return;}var a=new Date().getTime();var b=jQuery.createUploadForm(a,l.fileElementId,(typeof(l.data)=="undefined"?false:l.data),l.fileElement);var i=jQuery.createUploadIframe(a,l.secureuri);var h="jUploadFrame"+a;var j="jUploadForm"+a;if(l.global&&!jQuery.active++){jQuery.event.trigger("ajaxStart");}var c=false;var f={};if(l.global){jQuery.event.trigger("ajaxSend",[f,l]);}var d=function(m){var q=document.getElementById(h);try{if(q.contentWindow){f.responseText=q.contentWindow.document.body?q.contentWindow.document.body.innerHTML:null;f.responseXML=q.contentWindow.document.XMLDocument?q.contentWindow.document.XMLDocument:q.contentWindow.document;}else{if(q.contentDocument){f.responseText=q.contentDocument.document.body?q.contentDocument.document.body.innerHTML:null;f.responseXML=q.contentDocument.document.XMLDocument?q.contentDocument.document.XMLDocument:q.contentDocument.document;}}}catch(p){jQuery.handleError(l,f,null,p);}if(f||m=="timeout"){c=true;var n;try{n=m!="timeout"?"success":"error";if(n!="error"){var o=jQuery.uploadHttpData(f,l.dataType);if(l.success){l.success(o,n);}if(l.global){jQuery.event.trigger("ajaxSuccess",[f,l]);}}else{jQuery.handleError(l,f,n);}}catch(p){n="error";jQuery.handleError(l,f,n,p);}if(l.global){jQuery.event.trigger("ajaxComplete",[f,l]);}if(l.global&&!--jQuery.active){jQuery.event.trigger("ajaxStop");}if(l.complete){l.complete(f,n);}jQuery(q).unbind();setTimeout(function(){try{jQuery(q).remove();jQuery(b).remove();}catch(r){jQuery.handleError(l,f,null,r);}},100);f=null;}};if(l.timeout>0){setTimeout(function(){if(!c){d("timeout");}},l.timeout);}try{var b=jQuery("#"+j);jQuery(b).attr("action",l.url);jQuery(b).attr("method","POST");jQuery(b).attr("target",h);if(b.encoding){jQuery(b).attr("encoding","multipart/form-data");}else{jQuery(b).attr("enctype","multipart/form-data");}jQuery(b).submit();}catch(g){jQuery.handleError(l,f,null,g);}jQuery("#"+h).load(d);return{abort:function(){try{jQuery("#"+h).remove();jQuery(b).remove();}catch(m){}}};},uploadHttpData:function(r,type){var data=!type;data=type=="xml"||data?r.responseXML:r.responseText;if(type=="script"){jQuery.globalEval(data);}if(type=="json"){var reg=/<pre.+?>(.+)<\/pre>/g;data=data.match(reg);eval("data = "+RegExp.$1);}if(type=="html"){jQuery("<div>").html(data).evalScripts();}return data;},handleError:function(c,b,a,d){if(c.error){c.error(b,a,d);}if(c.global){jQuery.event.trigger("ajaxError",[b,c,d]);}}});
