var uploadPreview=function(b){var a=this;a.IsNull=function(c){if(typeof(c)=="function"){return false;}if(c==undefined||c==null||c==""||c.length==0){return true;}return false;};a.DefautlSetting={UpBtn:null,DivShow:null,ImgShow:null,Width:100,Height:100,ImgType:["gif","jpeg","jpg","bmp","png"],ErrMsg:"选择文件错误,图片类型必须是(gif,jpeg,jpg,bmp,png)中的一种",callback:function(){}};a.Setting={UpBtn:a.IsNull(b.UpBtn)?a.DefautlSetting.UpBtn:b.UpBtn,DivShow:a.IsNull(b.DivShow)?a.DefautlSetting.DivShow:b.DivShow,ImgShow:a.IsNull(b.ImgShow)?a.DefautlSetting.ImgShow:b.ImgShow,Width:a.IsNull(b.Width)?a.DefautlSetting.Width:b.Width,Height:a.IsNull(b.Height)?a.DefautlSetting.Height:b.Height,ImgType:a.IsNull(b.ImgType)?a.DefautlSetting.ImgType:b.ImgType,ErrMsg:a.IsNull(b.ErrMsg)?a.DefautlSetting.ErrMsg:b.ErrMsg,callback:a.IsNull(b.callback)?a.DefautlSetting.callback:b.callback};a.getObjectURL=function(d){var c=null;if(window.createObjectURL!=undefined){c=window.createObjectURL(d);}else{if(window.URL!=undefined){c=window.URL.createObjectURL(d);}else{if(window.webkitURL!=undefined){c=window.webkitURL.createObjectURL(d);}}}return c;};a.Bind=function(){a.Setting.UpBtn.onchange=function(){if(this.value){if(!RegExp(".("+a.Setting.ImgType.join("|")+")$","i").test(this.value.toLowerCase())){alert(a.Setting.ErrMsg);this.value="";return false;}if(navigator.userAgent.indexOf("MSIE")>-1){try{a.Setting.ImgShow.src=a.getObjectURL(this.files[0]);}catch(c){var f=a.Setting.DivShow;this.select();top.parent.document.body.focus();var d=document.selection.createRange().text;document.selection.empty();a.Setting.ImgShow.style.display="none";f.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod=scale)";f.style.width=a.Setting.Width+"px";f.style.height=a.Setting.Height+"px";f.filters.item("DXImageTransform.Microsoft.AlphaImageLoader").src=d;}}else{a.Setting.ImgShow.src=a.getObjectURL(this.files[0]);}a.Setting.callback();}};};a.Bind();};

