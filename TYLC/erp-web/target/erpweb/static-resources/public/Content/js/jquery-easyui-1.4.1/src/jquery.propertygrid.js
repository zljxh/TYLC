/**
 * jQuery EasyUI 1.4.1
 * 
 * Copyright (c) 2009-2014 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the GPL license: http://www.gnu.org/licenses/gpl.txt
 * To use it on other terms please contact us at info@jeasyui.com
 *
 */


!function(t){function r(r){var d=(t.data(r,"propertygrid"),t.data(r,"propertygrid").options);t(r).datagrid(t.extend({},d,{cls:"propertygrid",view:d.showGroup?d.groupView:d.view,onBeforeEdit:function(e,a){if(0==d.onBeforeEdit.call(r,e,a))return!1;var i=t(this),a=i.datagrid("getRows")[e];i.datagrid("getColumnOption","value").editor=a.editor},onClickCell:function(i,o,n){if(a!=this&&(e(a),a=this),d.editIndex!=i){e(a),t(this).datagrid("beginEdit",i);var s=t(this).datagrid("getEditor",{index:i,field:o});if(s||(s=t(this).datagrid("getEditor",{index:i,field:"value"})),s){var l=t(s.target);(l.data("textbox")?l.textbox("textbox"):l).focus(),d.editIndex=i}}d.onClickCell.call(r,i,o,n)},loadFilter:function(t){return e(this),d.loadFilter.call(this,t)}}))}function e(r){var e=t(r);if(e.length){t.data(r,"propertygrid").options.finder.getTr(r,null,"editing").each(function(){var r=parseInt(t(this).attr("datagrid-row-index"));e.datagrid("validateRow",r)?e.datagrid("endEdit",r):e.datagrid("cancelEdit",r)})}}var a;t(document).unbind(".propertygrid").bind("mousedown.propertygrid",function(r){t(r.target).closest("div.datagrid-view,div.combo-panel").length||(e(a),a=void 0)}),t.fn.propertygrid=function(e,a){if("string"==typeof e){var d=t.fn.propertygrid.methods[e];return d?d(this,a):this.datagrid(e,a)}return e=e||{},this.each(function(){var a=t.data(this,"propertygrid");if(a)t.extend(a.options,e);else{var d=t.extend({},t.fn.propertygrid.defaults,t.fn.propertygrid.parseOptions(this),e);d.frozenColumns=t.extend(!0,[],d.frozenColumns),d.columns=t.extend(!0,[],d.columns),t.data(this,"propertygrid",{options:d})}r(this)})},t.fn.propertygrid.methods={options:function(r){return t.data(r[0],"propertygrid").options}},t.fn.propertygrid.parseOptions=function(r){return t.extend({},t.fn.datagrid.parseOptions(r),t.parser.parseOptions(r,[{showGroup:"boolean"}]))};var d=t.extend({},t.fn.datagrid.defaults.view,{render:function(r,e,a){for(var d=[],i=this.groups,o=0;o<i.length;o++)d.push(this.renderGroup.call(this,r,o,i[o],a));t(e).html(d.join(""))},renderGroup:function(r,e,a,d){var i=t.data(r,"datagrid"),o=i.options,n=t(r).datagrid("getColumnFields",d),s=[];s.push('<div class="datagrid-group" group-index='+e+">"),s.push('<table cellspacing="0" cellpadding="0" border="0" style="height:100%"><tbody>'),s.push("<tr>"),(d&&(o.rownumbers||o.frozenColumns.length)||!d&&!o.rownumbers&&!o.frozenColumns.length)&&s.push('<td style="border:0;text-align:center;width:25px"><span class="datagrid-row-expander datagrid-row-collapse" style="display:inline-block;width:16px;height:16px;cursor:pointer">&nbsp;</span></td>'),s.push('<td style="border:0;">'),d||(s.push('<span class="datagrid-group-title">'),s.push(o.groupFormatter.call(r,a.value,a.rows)),s.push("</span>")),s.push("</td>"),s.push("</tr>"),s.push("</tbody></table>"),s.push("</div>"),s.push('<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>');for(var l=a.startIndex,p=0;p<a.rows.length;p++){var g=o.rowStyler?o.rowStyler.call(r,l,a.rows[p]):"",u="",h="";"string"==typeof g?h=g:g&&(u=g.class||"",h=g.style||"");var c='class="datagrid-row '+(l%2&&o.striped?"datagrid-row-alt ":" ")+u+'"',f=h?'style="'+h+'"':"",v=i.rowIdPrefix+"-"+(d?1:2)+"-"+l;s.push('<tr id="'+v+'" datagrid-row-index="'+l+'" '+c+" "+f+">"),s.push(this.renderRow.call(this,r,n,d,l,a.rows[p])),s.push("</tr>"),l++}return s.push("</tbody></table>"),s.join("")},bindEvents:function(r){var e=t.data(r,"datagrid"),a=e.dc,d=a.body1.add(a.body2),i=(t.data(d[0],"events")||t._data(d[0],"events")).click[0].handler;d.unbind("click").bind("click",function(e){var a=t(e.target),d=a.closest("span.datagrid-row-expander");if(d.length){var o=d.closest("div.datagrid-group").attr("group-index");d.hasClass("datagrid-row-collapse")?t(r).datagrid("collapseGroup",o):t(r).datagrid("expandGroup",o)}else i(e);e.stopPropagation()})},onBeforeRender:function(r,e){var a=t.data(r,"datagrid"),d=a.options;!function(){t("#datagrid-group-style").length||t("head").append('<style id="datagrid-group-style">.datagrid-group{height:25px;overflow:hidden;font-weight:bold;border-bottom:1px solid #ccc;}</style>')}();for(var i=[],o=0;o<e.length;o++){var n=e[o],s=function(t){for(var r=0;r<i.length;r++){var e=i[r];if(e.value==t)return e}return null}(n[d.groupField]);s?s.rows.push(n):(s={value:n[d.groupField],rows:[n]},i.push(s))}for(var l=0,p=[],o=0;o<i.length;o++){var s=i[o];s.startIndex=l,l+=s.rows.length,p=p.concat(s.rows)}a.data.rows=p,this.groups=i;var g=this;setTimeout(function(){g.bindEvents(r)},0)}});t.extend(t.fn.datagrid.methods,{expandGroup:function(r,e){return r.each(function(){var r=t.data(this,"datagrid").dc.view,a=r.find(void 0!=e?'div.datagrid-group[group-index="'+e+'"]':"div.datagrid-group"),d=a.find("span.datagrid-row-expander");d.hasClass("datagrid-row-expand")&&(d.removeClass("datagrid-row-expand").addClass("datagrid-row-collapse"),a.next("table").show()),t(this).datagrid("fixRowHeight")})},collapseGroup:function(r,e){return r.each(function(){var r=t.data(this,"datagrid").dc.view,a=r.find(void 0!=e?'div.datagrid-group[group-index="'+e+'"]':"div.datagrid-group"),d=a.find("span.datagrid-row-expander");d.hasClass("datagrid-row-collapse")&&(d.removeClass("datagrid-row-collapse").addClass("datagrid-row-expand"),a.next("table").hide()),t(this).datagrid("fixRowHeight")})}}),t.extend(d,{refreshGroupTitle:function(r,e){var a=t.data(r,"datagrid"),d=a.options,i=a.dc,o=this.groups[e];i.body2.children("div.datagrid-group[group-index="+e+"]").find("span.datagrid-group-title").html(d.groupFormatter.call(r,o.value,o.rows))},insertRow:function(r,e,a){function d(t,e){var a=e?1:2,d=n.finder.getTr(r,t-1,"body",a);n.finder.getTr(r,t,"body",a).insertAfter(d)}for(var i,o=t.data(r,"datagrid"),n=o.options,s=o.dc,l=null,p=0;p<this.groups.length;p++)if(this.groups[p].value==a[n.groupField]){l=this.groups[p],i=p;break}l?(void 0!=e&&null!=e||(e=o.data.rows.length),e<l.startIndex?e=l.startIndex:e>l.startIndex+l.rows.length&&(e=l.startIndex+l.rows.length),t.fn.datagrid.defaults.view.insertRow.call(this,r,e,a),e>=l.startIndex+l.rows.length&&(d(e,!0),d(e,!1)),l.rows.splice(e-l.startIndex,0,a)):(l={value:a[n.groupField],rows:[a],startIndex:o.data.rows.length},i=this.groups.length,s.body1.append(this.renderGroup.call(this,r,i,l,!0)),s.body2.append(this.renderGroup.call(this,r,i,l,!1)),this.groups.push(l),o.data.rows.push(a)),this.refreshGroupTitle(r,i)},updateRow:function(r,e,a){var d=t.data(r,"datagrid").options;t.fn.datagrid.defaults.view.updateRow.call(this,r,e,a);var i=d.finder.getTr(r,e,"body",2).closest("table.datagrid-btable"),o=parseInt(i.prev().attr("group-index"));this.refreshGroupTitle(r,o)},deleteRow:function(r,e){var a=t.data(r,"datagrid"),d=a.options,i=a.dc,o=i.body1.add(i.body2),n=d.finder.getTr(r,e,"body",2).closest("table.datagrid-btable"),s=parseInt(n.prev().attr("group-index"));t.fn.datagrid.defaults.view.deleteRow.call(this,r,e);var l=this.groups[s];if(l.rows.length>1)l.rows.splice(e-l.startIndex,1),this.refreshGroupTitle(r,s);else{o.children("div.datagrid-group[group-index="+s+"]").remove();for(var p=s+1;p<this.groups.length;p++)o.children("div.datagrid-group[group-index="+p+"]").attr("group-index",p-1);this.groups.splice(s,1)}for(var e=0,p=0;p<this.groups.length;p++){var l=this.groups[p];l.startIndex=e,e+=l.rows.length}}}),t.fn.propertygrid.defaults=t.extend({},t.fn.datagrid.defaults,{singleSelect:!0,remoteSort:!1,fitColumns:!0,loadMsg:"",frozenColumns:[[{field:"f",width:16,resizable:!1}]],columns:[[{field:"name",title:"Name",width:100,sortable:!0},{field:"value",title:"Value",width:100,resizable:!1}]],showGroup:!1,groupView:d,groupField:"group",groupFormatter:function(t,r){return t}})}(jQuery);
//# sourceMappingURL=jquery.propertygrid.js.map