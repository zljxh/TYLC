/**
 * jQuery EasyUI 1.4.2
 * 
 * Copyright (c) 2009-2015 www.jeasyui.com. All rights reserved.
 *
 * Licensed under the GPL license: http://www.gnu.org/licenses/gpl.txt
 * To use it on other terms please contact us at info@jeasyui.com
 *
 */


!function(t){function r(r){var a=(t.data(r,"propertygrid"),t.data(r,"propertygrid").options);t(r).datagrid(t.extend({},a,{cls:"propertygrid",view:a.showGroup?a.groupView:a.view,onBeforeEdit:function(e,d){if(0==a.onBeforeEdit.call(r,e,d))return!1;var i=t(this),d=i.datagrid("getRows")[e];i.datagrid("getColumnOption","value").editor=d.editor},onClickCell:function(i,o,n){if(d!=this&&(e(d),d=this),a.editIndex!=i){e(d),t(this).datagrid("beginEdit",i);var s=t(this).datagrid("getEditor",{index:i,field:o});if(s||(s=t(this).datagrid("getEditor",{index:i,field:"value"})),s){var l=t(s.target);(l.data("textbox")?l.textbox("textbox"):l).focus(),a.editIndex=i}}a.onClickCell.call(r,i,o,n)},loadFilter:function(t){return e(this),a.loadFilter.call(this,t)}}))}function e(r){var e=t(r);if(e.length){var d=t.data(r,"propertygrid").options;d.finder.getTr(r,null,"editing").each(function(){var r=parseInt(t(this).attr("datagrid-row-index"));e.datagrid("validateRow",r)?e.datagrid("endEdit",r):e.datagrid("cancelEdit",r)}),d.editIndex=void 0}}var d;t(document).unbind(".propertygrid").bind("mousedown.propertygrid",function(r){t(r.target).closest("div.datagrid-view,div.combo-panel").length||(e(d),d=void 0)}),t.fn.propertygrid=function(e,d){if("string"==typeof e){var a=t.fn.propertygrid.methods[e];return a?a(this,d):this.datagrid(e,d)}return e=e||{},this.each(function(){var d=t.data(this,"propertygrid");if(d)t.extend(d.options,e);else{var a=t.extend({},t.fn.propertygrid.defaults,t.fn.propertygrid.parseOptions(this),e);a.frozenColumns=t.extend(!0,[],a.frozenColumns),a.columns=t.extend(!0,[],a.columns),t.data(this,"propertygrid",{options:a})}r(this)})},t.fn.propertygrid.methods={options:function(r){return t.data(r[0],"propertygrid").options}},t.fn.propertygrid.parseOptions=function(r){return t.extend({},t.fn.datagrid.parseOptions(r),t.parser.parseOptions(r,[{showGroup:"boolean"}]))};var a=t.extend({},t.fn.datagrid.defaults.view,{render:function(r,e,d){for(var a=[],i=this.groups,o=0;o<i.length;o++)a.push(this.renderGroup.call(this,r,o,i[o],d));t(e).html(a.join(""))},renderGroup:function(r,e,d,a){var i=t.data(r,"datagrid"),o=i.options,n=t(r).datagrid("getColumnFields",a),s=[];s.push('<div class="datagrid-group" group-index='+e+">"),s.push('<table cellspacing="0" cellpadding="0" border="0" style="height:100%"><tbody>'),s.push("<tr>"),(a&&(o.rownumbers||o.frozenColumns.length)||!a&&!o.rownumbers&&!o.frozenColumns.length)&&s.push('<td style="border:0;text-align:center;width:25px"><span class="datagrid-row-expander datagrid-row-collapse" style="display:inline-block;width:16px;height:16px;cursor:pointer">&nbsp;</span></td>'),s.push('<td style="border:0;">'),a||(s.push('<span class="datagrid-group-title">'),s.push(o.groupFormatter.call(r,d.value,d.rows)),s.push("</span>")),s.push("</td>"),s.push("</tr>"),s.push("</tbody></table>"),s.push("</div>"),s.push('<table class="datagrid-btable" cellspacing="0" cellpadding="0" border="0"><tbody>');for(var l=d.startIndex,p=0;p<d.rows.length;p++){var g=o.rowStyler?o.rowStyler.call(r,l,d.rows[p]):"",u="",h="";"string"==typeof g?h=g:g&&(u=g.class||"",h=g.style||"");var c='class="datagrid-row '+(l%2&&o.striped?"datagrid-row-alt ":" ")+u+'"',f=h?'style="'+h+'"':"",v=i.rowIdPrefix+"-"+(a?1:2)+"-"+l;s.push('<tr id="'+v+'" datagrid-row-index="'+l+'" '+c+" "+f+">"),s.push(this.renderRow.call(this,r,n,a,l,d.rows[p])),s.push("</tr>"),l++}return s.push("</tbody></table>"),s.join("")},bindEvents:function(r){var e=t.data(r,"datagrid"),d=e.dc,a=d.body1.add(d.body2),i=(t.data(a[0],"events")||t._data(a[0],"events")).click[0].handler;a.unbind("click").bind("click",function(e){var d=t(e.target),a=d.closest("span.datagrid-row-expander");if(a.length){var o=a.closest("div.datagrid-group").attr("group-index");a.hasClass("datagrid-row-collapse")?t(r).datagrid("collapseGroup",o):t(r).datagrid("expandGroup",o)}else i(e);e.stopPropagation()})},onBeforeRender:function(r,e){var d=t.data(r,"datagrid"),a=d.options;!function(){t("#datagrid-group-style").length||t("head").append('<style id="datagrid-group-style">.datagrid-group{height:25px;overflow:hidden;font-weight:bold;border-bottom:1px solid #ccc;}</style>')}();for(var i=[],o=0;o<e.length;o++){var n=e[o],s=function(t){for(var r=0;r<i.length;r++){var e=i[r];if(e.value==t)return e}return null}(n[a.groupField]);s?s.rows.push(n):(s={value:n[a.groupField],rows:[n]},i.push(s))}for(var l=0,p=[],o=0;o<i.length;o++){var s=i[o];s.startIndex=l,l+=s.rows.length,p=p.concat(s.rows)}d.data.rows=p,this.groups=i;var g=this;setTimeout(function(){g.bindEvents(r)},0)}});t.extend(t.fn.datagrid.methods,{expandGroup:function(r,e){return r.each(function(){var r=t.data(this,"datagrid").dc.view,d=r.find(void 0!=e?'div.datagrid-group[group-index="'+e+'"]':"div.datagrid-group"),a=d.find("span.datagrid-row-expander");a.hasClass("datagrid-row-expand")&&(a.removeClass("datagrid-row-expand").addClass("datagrid-row-collapse"),d.next("table").show()),t(this).datagrid("fixRowHeight")})},collapseGroup:function(r,e){return r.each(function(){var r=t.data(this,"datagrid").dc.view,d=r.find(void 0!=e?'div.datagrid-group[group-index="'+e+'"]':"div.datagrid-group"),a=d.find("span.datagrid-row-expander");a.hasClass("datagrid-row-collapse")&&(a.removeClass("datagrid-row-collapse").addClass("datagrid-row-expand"),d.next("table").hide()),t(this).datagrid("fixRowHeight")})}}),t.extend(a,{refreshGroupTitle:function(r,e){var d=t.data(r,"datagrid"),a=d.options,i=d.dc,o=this.groups[e];i.body2.children("div.datagrid-group[group-index="+e+"]").find("span.datagrid-group-title").html(a.groupFormatter.call(r,o.value,o.rows))},insertRow:function(r,e,d){function a(t,e){var d=e?1:2,a=n.finder.getTr(r,t-1,"body",d);n.finder.getTr(r,t,"body",d).insertAfter(a)}for(var i,o=t.data(r,"datagrid"),n=o.options,s=o.dc,l=null,p=0;p<this.groups.length;p++)if(this.groups[p].value==d[n.groupField]){l=this.groups[p],i=p;break}l?(void 0!=e&&null!=e||(e=o.data.rows.length),e<l.startIndex?e=l.startIndex:e>l.startIndex+l.rows.length&&(e=l.startIndex+l.rows.length),t.fn.datagrid.defaults.view.insertRow.call(this,r,e,d),e>=l.startIndex+l.rows.length&&(a(e,!0),a(e,!1)),l.rows.splice(e-l.startIndex,0,d)):(l={value:d[n.groupField],rows:[d],startIndex:o.data.rows.length},i=this.groups.length,s.body1.append(this.renderGroup.call(this,r,i,l,!0)),s.body2.append(this.renderGroup.call(this,r,i,l,!1)),this.groups.push(l),o.data.rows.push(d)),this.refreshGroupTitle(r,i)},updateRow:function(r,e,d){var a=t.data(r,"datagrid").options;t.fn.datagrid.defaults.view.updateRow.call(this,r,e,d);var i=a.finder.getTr(r,e,"body",2).closest("table.datagrid-btable"),o=parseInt(i.prev().attr("group-index"));this.refreshGroupTitle(r,o)},deleteRow:function(r,e){var d=t.data(r,"datagrid"),a=d.options,i=d.dc,o=i.body1.add(i.body2),n=a.finder.getTr(r,e,"body",2).closest("table.datagrid-btable"),s=parseInt(n.prev().attr("group-index"));t.fn.datagrid.defaults.view.deleteRow.call(this,r,e);var l=this.groups[s];if(l.rows.length>1)l.rows.splice(e-l.startIndex,1),this.refreshGroupTitle(r,s);else{o.children("div.datagrid-group[group-index="+s+"]").remove();for(var p=s+1;p<this.groups.length;p++)o.children("div.datagrid-group[group-index="+p+"]").attr("group-index",p-1);this.groups.splice(s,1)}for(var e=0,p=0;p<this.groups.length;p++){var l=this.groups[p];l.startIndex=e,e+=l.rows.length}}}),t.fn.propertygrid.defaults=t.extend({},t.fn.datagrid.defaults,{singleSelect:!0,remoteSort:!1,fitColumns:!0,loadMsg:"",frozenColumns:[[{field:"f",width:16,resizable:!1}]],columns:[[{field:"name",title:"Name",width:100,sortable:!0},{field:"value",title:"Value",width:100,resizable:!1}]],showGroup:!1,groupView:a,groupField:"group",groupFormatter:function(t,r){return t}})}(jQuery);
//# sourceMappingURL=jquery.propertygrid.js.map